# Easy Cities 2D 🏙️

**Version: v0.5.0** | Last Updated: 2026-01-28

Cities Skylines風の戦略性を備えたブラウザ型都市建設シミュレーターです。
初期資金250,000円で都市を発展させ、人口、資金、快適度のバランスを取りながら経営を続けます。
タッチ対応で、デスクトップ・スマートフォン・タブレットで遊べます。

**🎮 [Play Online - Easy Cities 2D](https://warasugitewara.github.io/easy-cities-2d/)**

## ✨ 特徴

### 🎯 ゲーム機能
- **都市建設**: 道路、住宅、商業、工業、インフラを配置して都市を発展させます
- **経済システム**: 初期資金250,000円で開始し、税収と維持費で経営します
- **人口管理**: 建物の自動成長で人口が増加、段階的にレベルアップします
- **快適度システム**: 複数の要因で都市の住みやすさを測定
- **ゲーム設定**: 難易度選択、災害・公害・スラム化システムのON/OFF選択
- **タッチ対応**: マウス・タッチ両対応で、スマートフォンでもプレイ可能

### パラメーター
| 項目 | 説明 |
|------|------|
| **人口** | 各建物のレベルに応じた人口が増加 |
| **資金** | 建設コスト、税収、維持費で変動 |
| **快適度** | 緑地率、交通充実度、汚染度などで計算 |
| **月** | 経過時間（月次更新は月額コスト計算） |

### 🏗️ 建設可能な施設

#### インフラ
- **道路** (200円/タイル): 建物の成長を促進
- **駅** (5,000円): 周辺の発展を加速（1.5倍）
- **公園** (1,000円): 快適度向上用
- **警察署** (8,000円): 治安向上
- **消防署** (7,000円): 安全性向上
- **病院** (10,000円): 医療サービス
- **学校** (6,000円): 教育サービス
- **発電所** (15,000円): 電力供給
- **水処理施設** (12,000円): 水道管理

#### 住宅・商業・工業
- **住宅地** (L1-L4): 自動成長、人口増加
- **商業地** (L1-L4): 自動成長、雇用と収入
- **工業地** (L1-L4): 自動成長、雇用（汚染注意）

#### ランドマーク
- **スタジアム** (50,000円): 観光収入
- **空港** (80,000円): 航空収入

#### その他
- **削除**: 不要な建物を除去

### 建物レベル
| レベル | 人口 | 月額税収 | 説明 |
|--------|------|---------|------|
| L1 | 10人 | 20円 | 低層住宅 |
| L2 | 50人 | 60円 | 中層住宅 |
| L3 | 200人 | 150円 | 高層住宅 |
| L4 | 500人 | 300円 | 超高層ビル |

## 🎮 ゲーム画面

### 左側: 都市マップ
- **1024x1024ピクセル**: 高解像度で都市を表示
- **リアルタイム成長**: 配置した道路や駅の周辺から建物が自動成長
- **カラーコーディング**: 建物タイプに応じて色分け表示
- **ズーム機能**: 1.0x～3.0x倍率でスケール可能

### 右側: コントロールパネル
- **ダッシュボード**: 人口、資金、快適度、経過月を表示
- **タブメニュー**: 道路 | 住宅 | 商業 | 工業 | インフラ | ランドマーク | 削除
- **セーブ機能**: 3つのセーブスロット
- **インポート/エクスポート**: JSON形式でのデータ交換

## 操作方法

### 🖱️ マウス・タッチ操作
| 操作 | 効果 |
|------|------|
| **左クリック/タップ** | 選択したツールで建設 |
| **左ドラッグ** | 連続敷設（道路を続ける） |
| **右クリックドラッグ** | 画面の移動（パン） |
| **マウスホイール** | ズーム（1.0x～3.0x） |
| **タブボタン** | 建物カテゴリ切り替え |

### ⌨️ キーボード
| キー | 効果 |
|------|------|
| **R** | 道路モード |
| **S** | 住宅モード |
| **C** | 商業モード |
| **I** | 工業モード |
| **U** | インフラモード |
| **D** | 削除モード |
| **Space** | 連続敷設ON/OFF |

### 🔧 UIボタン
- **⚙️ 設定**: 難易度、災害・公害・スラム化システムを切り替え
- **💾 セーブ**: 現在のゲームデータを3つのスロットに保存
- **📂 ロード**: 保存されたデータを読み込み
- **📤 エクスポート**: ゲームデータをJSON形式でダウンロード
- **📥 インポート**: JSON形式のデータを読み込み

## 永続化機能

### LocalStorage（3つのセーブスロット）
各スロットに以下の情報を保存:
- マップデータ（128x128グリッド）
- 人口、資金、快適度、月
- 建設モード、ポーズ状態

### JSONエクスポート/インポート
```json
{
  "version": "1.0.0",
  "exportedAt": "2026-01-28T07:00:00.000Z",
  "gameState": {
    "map": [...],
    "population": 5000,
    "money": 150000,
    "comfort": 75,
    "month": 120,
    ...
  }
}
```

## 快適度スコア計算

快適度は以下5つの指標の平均値です:

1. **緑地率** (0-100): 公園の占める割合
2. **交通充実度** (0-100): 駅の数と分布
3. **人口密度** (0-100): 過密を避けるスコア
4. **資金状況** (0-100): 資金/初期資金の比率
5. **汚染度補正** (0-100): 工業地帯からの距離

## インストール

```bash
git clone https://github.com/warasugitewara/easy-cities-2d.git
cd easy-cities-2d
npm install
npm run dev
```

## ビルド

```bash
npm run build
```

生成されたファイルは `dist/` ディレクトリに出力されます。

## 技術スタック

- **言語**: TypeScript
- **ビルドツール**: Vite
- **レンダリング**: Canvas API
- **ストレージ**: LocalStorage + JSON
- **デプロイ**: GitHub Pages

## ファイル構成

```
src/
├── main.ts           # メインアプリケーション
├── engine.ts         # ゲームロジック・シミュレーション
├── renderer.ts       # Canvas描画処理
├── ui.ts             # UIコンポーネント・操作
├── storage.ts        # LocalStorage・JSON I/O
├── constants.ts      # ゲーム定数
└── style.css         # スタイル定義
```

## ゲームの目標

1. **都市を発展させる**: 建設して人口を増やす
2. **資金を管理する**: 税収で維持費をカバーする
3. **快適度を向上させる**: 公園や駅を配置して住環境を整える
4. **バランスを取る**: 成長と安定性の両立

## 難易度

Cities Skylines 2D版として設定されています:
- 初期資金が限られている
- 建設・維持費に戦略性が求められる
- 不適切な配置は経営破綻につながる

## ゲームオーバー条件

資金がマイナスになると破産しゲームオーバーです。

## 今後の予定

- [x] 複数の建物タイプ（住宅、商業、工業）
- [x] タブ式メニューUI（Cities Skylines風）
- [x] ゲーム設定画面（難易度、システムON/OFF）
- [x] タッチ対応（スマートフォン・タブレット）
- [x] ドラッグビルド機能（連続敷設）
- [x] カメラシステム（パン・ズーム）
- [x] インフラシステム実装（水道、電力、消防、病院）
- [x] 災害・イベント機能の実装（火災、病気）
- [x] マップサイズ選択オプション（小・中・大）
- [x] 複数マス占有建物（スタジアム、空港）
- [x] メニューに色サンプル表示
- [ ] スラム化・公害の実装
- [ ] シナリオモード（目標達成型）
- [ ] スコアランキング

## 📝 更新履歴

### v0.5.0 (2026-01-28)
**パフォーマンス最適化・UI改善・機能拡張**
- ✨ 火災・病気のビジュアル表示（赤・黄でハイライト）
- 🚀 大マップでのパフォーマンス最適化（サンプリング処理）
- 🎯 当たり判定修正（タイル中心ベース計算）
- 🛠️ 複数マス建築物の一括削除機能
- 🎨 インフラ・ランドマークメニューに色サンプル表示
- 🔍 メニューのレイアウト改善（見やすさ向上）

### v0.4.0 (2026-01-28)
**災害・インフラシステム実装**
- 🔥 火災システム（ランダム発生、消防署で消火）
- 🤒 病気システム（密集地発生、病院で治癒）
- ⚡ 電力供給システム（発電所から半径20マス）
- 💧 水道供給システム（水処理施設から半径15マス）
- 🏗️ ランドマークの複数マス対応（スタジアム4×4、空港6×6）
- 🎨 改善された色分け（RGB値最適化）

### v0.3.0 (2026-01-28)
**UI改善・建物拡張**
- 🎛️ ドラッグ可能なUIパネル
- ⏸ ゲーム速度制御（ポーズ・遅い・通常・高速）
- 🏗️ インフラ施設追加（駅、公園、警察署、消防署、病院、学校、発電所、水処理施設）
- 🏛️ ランドマーク実装（スタジアム、空港）
- 📊 複数マス占有建物システム

### v0.2.0 (2026-01-28)
**UI・マップサイズ拡張**
- 🎨 オーバーレイUI化（ダッシュボード、メニューのレイアウト改善）
- 📐 マップサイズ選択（小・中・大）
- 🔧 動的グリッドサイズ対応
- 🎯 GUI表示非表示ボタン
- 📱 タッチイベント完全対応

### v0.1.0 (2026-01-28)
**初版リリース**
- 🏙️ 基本的なゲーム機能（道路、住宅、商業、工業）
- 💰 経済システム（税収・維持費）
- 👥 人口管理（自動成長）
- 😊 快適度スコア計算
- 📱 タッチ・マウス対応
- 💾 セーブ・ロード機能
- 🎮 難易度選択（イージー・ノーマル・ハード）

## ライセンス

MIT License

## 貢献

バグ報告や機能リクエストは、GitHubのIssuesでお願いします。

## クレジット

**オリジナル版制作**: 松島さん  
**改良・2D版開発**: warasugitewara

---

**🏗️ Easy Cities 2D - ブラウザ型都市シミュレーター 🏗️**

楽しい都市経営をお楽しみください！質問やバグ報告は[GitHub Issues](https://github.com/warasugitewara/easy-cities-2d/issues)までお願いします。
